<div class="min-h-screen bg-gray-50">
  <!-- Header -->
  <div class="bg-white shadow-sm">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
      <div class="flex flex-col md:flex-row md:justify-between md:items-center gap-4">
        <div>
          <h1 class="text-3xl font-bold text-gray-800">Family Library</h1>
          <p class="text-gray-600 mt-1">Browse all books from your family</p>
        </div>
        <div class="flex items-center space-x-3">
          <!-- View Mode Toggle -->
          <div class="flex items-center bg-gray-100 rounded-lg p-1">
            <%= link_to library_path(params.permit(:search, :status, :favorited, :date_from, :date_to, :sort, :child_profile_id).merge(view_mode: 'grid')),
                class: "px-3 py-2 rounded transition #{@view_mode == 'grid' ? 'bg-white shadow-sm' : 'text-gray-600 hover:text-gray-800'}" do %>
              <%= icon "layout-grid", class: "w-4 h-4" %>
            <% end %>
            <%= link_to library_path(params.permit(:search, :status, :favorited, :date_from, :date_to, :sort, :child_profile_id).merge(view_mode: 'list')),
                class: "px-3 py-2 rounded transition #{@view_mode == 'list' ? 'bg-white shadow-sm' : 'text-gray-600 hover:text-gray-800'}" do %>
              <%= icon "list", class: "w-4 h-4" %>
            <% end %>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Main Content -->
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <% if flash[:notice] %>
      <div class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mb-6">
        <%= flash[:notice] %>
      </div>
    <% end %>

    <% if flash[:alert] %>
      <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-6">
        <%= flash[:alert] %>
      </div>
    <% end %>

    <!-- Statistics -->
    <%= render "books/statistics", statistics: @statistics %>

    <!-- Filters -->
    <%= render "books/filters", show_child_filter: true, child_profiles: @child_profiles %>

    <!-- Books List -->
    <%= turbo_frame_tag "books_list" do %>
      <% if @books.any? %>
        <div class="<%= @view_mode == 'grid' ? 'grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6' : 'space-y-4' %>">
          <% @books.each do |book| %>
            <%= render "books/book_card", book: book, child_profile: book.child_profile, show_child_info: true %>
          <% end %>
        </div>
      <% else %>
        <div class="bg-white rounded-lg shadow-md p-12 text-center">
          <div class="mb-4">
            <%= icon "book-open", class: "w-16 h-16 mx-auto text-gray-400" %>
          </div>
          <h3 class="text-xl font-bold text-gray-800 mb-2">No books found</h3>
          <% if params[:search].present? || params[:status].present? || params[:favorited].present? || params[:date_from].present? || params[:date_to].present? || params[:child_profile_id].present? %>
            <p class="text-gray-600 mb-6">Try adjusting your filters to see more results.</p>
            <%= link_to library_path, class: "bg-gray-200 text-gray-700 px-6 py-3 rounded-lg hover:bg-gray-300 transition duration-200 inline-flex items-center" do %>
              <%= icon "x", class: "w-5 h-5 mr-2" %>
              Clear Filters
            <% end %>
          <% else %>
            <p class="text-gray-600 mb-6">No books have been created yet. Start by selecting a child profile and creating a book!</p>
          <% end %>
        </div>
      <% end %>
    <% end %>
  </div>
</div>
