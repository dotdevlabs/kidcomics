<div class="min-h-screen bg-gray-50">
  <div class="max-w-3xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <div class="mb-6">
      <%= link_to child_profile_book_drawings_path(@child_profile, @book), class: "text-gray-600 hover:text-gray-800 inline-flex items-center" do %>
        <i data-lucide="arrow-left" class="w-5 h-5 mr-2"></i>
        Back to Drawings
      <% end %>
    </div>

    <div class="bg-white rounded-lg shadow-md p-8">
      <h1 class="text-3xl font-bold text-gray-800 mb-6">Edit Drawing</h1>

      <%= form_with(model: [@child_profile, @book, @drawing], local: true) do |form| %>
        <% if @drawing.errors.any? %>
          <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-6">
            <h3 class="font-bold mb-2"><%= pluralize(@drawing.errors.count, "error") %> prohibited this drawing from being saved:</h3>
            <ul class="list-disc list-inside">
              <% @drawing.errors.full_messages.each do |message| %>
                <li><%= message %></li>
              <% end %>
            </ul>
          </div>
        <% end %>

        <!-- Current Image -->
        <div class="mb-6">
          <label class="block text-sm font-medium text-gray-700 mb-2">Current Image</label>
          <div class="w-64 h-64 bg-gray-100 rounded-lg overflow-hidden">
            <%= image_tag @drawing.image.variant(:medium), class: "w-full h-full object-cover" if @drawing.image.attached? %>
          </div>
        </div>

        <!-- Replace Image -->
        <div class="mb-6">
          <%= form.label :image, "Replace Image (optional)", class: "block text-sm font-medium text-gray-700 mb-2" %>
          <%= form.file_field :image,
              accept: "image/jpeg,image/png,image/heic,image/heif,image/webp",
              class: "block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-purple-50 file:text-purple-700 hover:file:bg-purple-100" %>
          <p class="text-sm text-gray-500 mt-1">Supported formats: JPEG, PNG, HEIC, WebP (max 10MB)</p>
        </div>

        <!-- Tag -->
        <div class="mb-6">
          <%= form.label :tag, class: "block text-sm font-medium text-gray-700 mb-2" %>
          <%= form.select :tag,
              [
                ['No tag', ''],
                ['Character', 'character'],
                ['Background', 'background'],
                ['Object', 'object']
              ],
              {},
              class: "w-full md:w-64 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent" %>
        </div>

        <!-- Caption -->
        <div class="mb-6">
          <%= form.label :caption, class: "block text-sm font-medium text-gray-700 mb-2" %>
          <%= form.text_area :caption,
              rows: 3,
              class: "w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",
              placeholder: "Add a caption..." %>
        </div>

        <!-- Action Buttons -->
        <div class="flex space-x-3">
          <%= form.submit "Update Drawing", class: "bg-purple-600 text-white px-6 py-3 rounded-lg hover:bg-purple-700 transition duration-200 cursor-pointer" %>
          <%= link_to "Cancel", child_profile_book_drawings_path(@child_profile, @book), class: "bg-gray-200 text-gray-700 px-6 py-3 rounded-lg hover:bg-gray-300 transition duration-200 inline-block" %>
        </div>
      <% end %>
    </div>
  </div>
</div>
